# Certificate Monitoring Configuration for PA Ecosystem
# Comprehensive monitoring and alerting for certificate management

# SSL Labs API Configuration
SSL_LABS_API_URL="https://api.ssllabs.com/api/v3/analyze"
SSL_LABS_CHECK_INTERVAL=3600  # 1 hour
SSL_LABS_TIMEOUT=30

# Certificate monitoring settings
CERT_CHECK_INTERVAL=86400     # 24 hours
CERT_EXPIRY_WARNING_DAYS=30
CERT_EXPIRY_CRITICAL_DAYS=7
CERT_RENEWAL_THRESHOLD_DAYS=30

# TLS Configuration monitoring
TLS_CONFIG_CHECK_INTERVAL=3600  # 1 hour
TLS_SECURITY_SCAN_INTERVAL=86400  # 24 hours

# Alerting configuration
ALERT_EMAIL="admin@pa-ecosystem.local"
ALERT_WEBHOOK_URL=""
ALERT_SLACK_WEBHOOK=""
ALERT_DISCORD_WEBHOOK=""

# Notification thresholds
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_RETRY_DELAY=300  # 5 minutes

# Security thresholds
MIN_TLS_VERSION="1.2"
MAX_CERT_AGE_DAYS=90
REQUIRED_CIPHER_STRENGTH=128
MIN_KEY_SIZE=2048

# Monitoring endpoints
HEALTH_CHECK_ENDPOINTS=(
    "https://api.pa-ecosystem.local/health"
    "https://app.pa-ecosystem.local/health"
    "https://admin.pa-ecosystem.local/health"
    "https://monitoring.pa-ecosystem.local/health"
)

# Certificate domains to monitor
CERTIFICATE_DOMAINS=(
    "pa-ecosystem.local"
    "api.pa-ecosystem.local"
    "app.pa-ecosystem.local"
    "admin.pa-ecosystem.local"
    "monitoring.pa-ecosystem.local"
)

# TLS Security checks
TLS_SECURITY_CHECKS=(
    "protocol_version"
    "cipher_strength"
    "certificate_validity"
    "ocsp_stapling"
    "hsts_header"
    "security_headers"
    "vulnerability_scan"
)

# Performance monitoring
PERFORMANCE_MONITORING=true
PERFORMANCE_METRICS=(
    "tls_handshake_time"
    "certificate_validation_time"
    "ocsp_response_time"
    "connection_establishment_time"
)

# Logging configuration
LOG_LEVEL="INFO"
LOG_FORMAT="json"
LOG_RETENTION_DAYS=30
LOG_ROTATION_SIZE="100M"

# Backup configuration
BACKUP_ENABLED=true
BACKUP_INTERVAL=86400  # 24 hours
BACKUP_RETENTION_DAYS=90
BACKUP_LOCATION="/backups/certificates"

# Compliance settings
COMPLIANCE_STANDARDS=(
    "PCI_DSS"
    "SOC2"
    "ISO27001"
    "NIST"
)

# Reporting configuration
REPORT_GENERATION=true
REPORT_INTERVAL=604800  # 1 week
REPORT_FORMATS=("json" "html" "pdf")
REPORT_LOCATION="/reports/certificates"

# Integration settings
INTEGRATION_ENABLED=true
INTEGRATION_SERVICES=(
    "prometheus"
    "grafana"
    "elasticsearch"
    "kibana"
)

# Automated actions
AUTO_RENEWAL_ENABLED=true
AUTO_BACKUP_ENABLED=true
AUTO_REPORTING_ENABLED=true
AUTO_ALERTING_ENABLED=true

# Security settings
ENCRYPTION_AT_REST=true
ACCESS_CONTROL_ENABLED=true
AUDIT_LOGGING_ENABLED=true
SECURITY_SCANNING_ENABLED=true

# High availability settings
HA_ENABLED=false
HA_PRIMARY_NODE=""
HA_SECONDARY_NODES=()
HA_FAILOVER_TIMEOUT=30

# Disaster recovery settings
DR_ENABLED=true
DR_BACKUP_LOCATION=""
DR_RESTORE_PROCEDURE=""
DR_TESTING_INTERVAL=2592000  # 30 days
