# Security Logging Configuration for PA Ecosystem
# Comprehensive logging configuration for security events and monitoring

# Logging levels
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_ENCODING=utf-8

# Log destinations
LOG_DESTINATIONS=(
    "file"
    "syslog"
    "elasticsearch"
    "kafka"
)

# Security event logging
SECURITY_EVENT_LOGGING=true
SECURITY_LOG_CATEGORIES=(
    "authentication"
    "authorization"
    "access_control"
    "data_access"
    "system_events"
    "network_events"
    "application_events"
    "security_events"
)

# Log sources and patterns
LOG_SOURCES=(
    "/var/log/auth.log"
    "/var/log/syslog"
    "/var/log/nginx/access.log"
    "/var/log/nginx/error.log"
    "/var/log/mysql/error.log"
    "/var/log/postgresql/postgresql.log"
    "/var/log/docker.log"
    "/var/log/audit.log"
    "/var/log/secure.log"
)

# Security event patterns
SECURITY_PATTERNS=(
    "authentication_failure"
    "authentication_success"
    "authorization_failure"
    "privilege_escalation"
    "data_access_denied"
    "data_access_granted"
    "system_compromise"
    "malware_detection"
    "network_intrusion"
    "policy_violation"
)

# Log aggregation settings
LOG_AGGREGATION=true
AGGREGATION_INTERVAL=60  # seconds
AGGREGATION_BATCH_SIZE=1000
AGGREGATION_TIMEOUT=30

# Log retention and rotation
LOG_RETENTION_DAYS=90
LOG_ROTATION_SIZE=100M
LOG_ROTATION_FREQUENCY=daily
LOG_COMPRESSION=true
LOG_ARCHIVAL_ENABLED=true

# Log integrity and security
LOG_INTEGRITY_CHECK=true
LOG_ENCRYPTION=true
LOG_DIGITAL_SIGNATURES=true
LOG_TAMPER_DETECTION=true
LOG_BACKUP_ENABLED=true

# Performance monitoring
PERFORMANCE_MONITORING=true
LOG_PROCESSING_METRICS=true
LOG_STORAGE_METRICS=true
LOG_NETWORK_METRICS=true

# Alerting configuration
ALERTING_ENABLED=true
ALERT_THRESHOLDS=(
    "authentication_failures:10:5_minutes:high"
    "authorization_failures:5:5_minutes:medium"
    "privilege_escalation:1:1_minute:critical"
    "data_access_denied:20:10_minutes:medium"
    "system_compromise:1:1_minute:critical"
    "malware_detection:1:1_minute:critical"
    "network_intrusion:5:5_minutes:high"
    "policy_violation:10:10_minutes:medium"
)

# Compliance logging
COMPLIANCE_LOGGING=true
COMPLIANCE_FRAMEWORKS=(
    "PCI_DSS"
    "SOC2"
    "ISO27001"
    "NIST"
    "GDPR"
    "HIPAA"
)

# Audit logging
AUDIT_LOGGING=true
AUDIT_EVENTS=(
    "user_login"
    "user_logout"
    "user_creation"
    "user_deletion"
    "permission_change"
    "role_assignment"
    "data_access"
    "data_modification"
    "data_deletion"
    "system_configuration_change"
    "security_policy_change"
    "administrative_action"
)

# Network logging
NETWORK_LOGGING=true
NETWORK_EVENTS=(
    "connection_established"
    "connection_terminated"
    "connection_refused"
    "port_scan"
    "network_anomaly"
    "traffic_analysis"
    "bandwidth_usage"
    "protocol_analysis"
)

# Application logging
APPLICATION_LOGGING=true
APPLICATION_EVENTS=(
    "api_access"
    "api_authentication"
    "api_authorization"
    "api_rate_limiting"
    "api_error"
    "database_query"
    "database_transaction"
    "file_access"
    "file_modification"
    "service_start"
    "service_stop"
    "service_error"
)

# Container logging
CONTAINER_LOGGING=true
CONTAINER_EVENTS=(
    "container_start"
    "container_stop"
    "container_restart"
    "container_error"
    "container_resource_usage"
    "container_security_event"
    "container_network_event"
)

# Database logging
DATABASE_LOGGING=true
DATABASE_EVENTS=(
    "connection_attempt"
    "authentication"
    "query_execution"
    "transaction_start"
    "transaction_commit"
    "transaction_rollback"
    "privilege_change"
    "schema_change"
    "data_modification"
)

# Web server logging
WEB_LOGGING=true
WEB_EVENTS=(
    "http_request"
    "http_response"
    "authentication"
    "authorization"
    "access_denied"
    "error_response"
    "rate_limiting"
    "ssl_handshake"
    "session_management"
)

# Log correlation
LOG_CORRELATION=true
CORRELATION_RULES=(
    "authentication_failure_followed_by_success"
    "multiple_authorization_failures"
    "privilege_escalation_sequence"
    "data_access_pattern_anomaly"
    "network_intrusion_indicators"
    "system_compromise_indicators"
)

# Machine learning
MACHINE_LEARNING_ENABLED=false
ML_MODELS=(
    "anomaly_detection"
    "behavior_analysis"
    "threat_classification"
    "risk_assessment"
)

# Log analysis
LOG_ANALYSIS=true
ANALYSIS_TYPES=(
    "real_time"
    "batch"
    "streaming"
    "historical"
)

# Reporting
REPORTING_ENABLED=true
REPORT_TYPES=(
    "security_summary"
    "threat_analysis"
    "compliance_report"
    "audit_report"
    "performance_report"
    "incident_report"
)

REPORT_SCHEDULES=(
    "daily:security_summary"
    "weekly:threat_analysis"
    "monthly:compliance_report"
    "quarterly:audit_report"
    "on_demand:incident_report"
)

# Integration settings
INTEGRATION_ENABLED=true
INTEGRATION_SERVICES=(
    "elasticsearch"
    "kibana"
    "logstash"
    "kafka"
    "prometheus"
    "grafana"
    "splunk"
    "splunk_enterprise"
)

# High availability
HA_ENABLED=false
HA_PRIMARY_NODE=""
HA_SECONDARY_NODES=()
HA_FAILOVER_TIMEOUT=30

# Disaster recovery
DR_ENABLED=true
DR_BACKUP_LOCATION=""
DR_RESTORE_PROCEDURE=""
DR_TESTING_INTERVAL=2592000  # 30 days

# Security settings
SECURITY_ENABLED=true
ENCRYPTION_AT_REST=true
ENCRYPTION_IN_TRANSIT=true
ACCESS_CONTROL_ENABLED=true
AUDIT_LOGGING_ENABLED=true

# Monitoring settings
MONITORING_ENABLED=true
HEALTH_CHECK_INTERVAL=30
METRICS_COLLECTION=true
ALERTING_ENABLED=true
DASHBOARD_ENABLED=true
