# 5-3 Update Docker Compose to integrate containerized Slackbot

[Back to task list](./tasks.md)

## Description

Add the containerized Slackbot service to the main docker-compose.yml file with proper configuration, networking, and environment variable management. This will integrate the Slackbot into the unified ecosystem while preserving all existing functionality.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-01-20 20:45:00 | Created | N/A | Proposed | Task file created | AI_Agent |
| 2025-01-20 20:45:00 | Status Change | Proposed | Agreed | Task approved and ready for implementation | AI_Agent |
| 2025-01-20 20:45:00 | Status Change | Agreed | InProgress | Started Docker Compose integration | AI_Agent |
| 2025-01-20 21:00:00 | Status Change | InProgress | Review | Docker Compose integration completed successfully | AI_Agent |

## Requirements

### Functional Requirements
1. **Service Definition**: Add Slackbot service to docker-compose.yml
2. **Network Integration**: Connect to pa-network for internal communication
3. **Environment Variables**: Configure all required Slack and Letta environment variables
4. **Health Checks**: Implement proper health check configuration
5. **Volume Mounts**: Set up state persistence for user data
6. **Service Dependencies**: Configure proper startup dependencies

### Technical Requirements
1. **Port Configuration**: Expose health check port (8081)
2. **Logging Integration**: Configure logging to match other services
3. **Restart Policy**: Set appropriate restart policy
4. **Resource Limits**: Define reasonable resource constraints
5. **Security**: Run with appropriate user permissions

## Implementation Plan

### Phase 1: Service Configuration
1. Add Slackbot service definition to docker-compose.yml
2. Configure network connectivity (pa-network)
3. Set up environment variable mapping
4. Configure volume mounts for state persistence

### Phase 2: Health and Monitoring
1. Implement health check configuration
2. Configure logging integration
3. Set up restart policies
4. Add service labels for monitoring

### Phase 3: Integration Testing
1. Test service startup and shutdown
2. Validate network connectivity to Letta
3. Test health check functionality
4. Verify logging output

## Verification

### Success Criteria
- [ ] Slackbot service added to docker-compose.yml
- [ ] Service connects to pa-network successfully
- [ ] Environment variables properly configured
- [ ] Health check responds correctly
- [ ] Service starts and stops with docker-compose commands
- [ ] Logs appear in centralized logging
- [ ] State persistence works with volume mounts
- [ ] Service can communicate with Letta container

### Test Commands
```bash
# Start the Slackbot service
docker-compose up -d slackbot

# Check service status
docker-compose ps slackbot

# Test health check
curl -f http://localhost:8081/health

# Check logs
docker-compose logs slackbot

# Test Letta connectivity (from within container)
docker-compose exec slackbot curl -f http://letta:8283/
```

## Files Modified

- `docker-compose.yml` (modified - add Slackbot service)
- `docs/delivery/5/5-3.md` (this file)